<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/123.png">
  <link rel="icon" type="image/png" href="../assets/img/123.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Admin Dashboard 
  </title>
  <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
  <!--icons-->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <!-- CSS Files -->
  <link href="/css/material-dashboard.css?v=2.1.2" rel="stylesheet" />
  <style>
    body{
    /* background-color: rgb(20, 207, 20); */

    }
    .btn-edit{
    background-color: rgb(20, 207, 20);
    border-radius: 5px;
}
.btn-remove{
    background-color: rgb(236, 26, 26);
    border-radius: 5px;

}
  </style>
</head>

<body>
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../assets/img/sidebar-1.jpg">
      <div class="logo">
        <a href="tables.html" class="simple-text logo-normal"> Admin Dashboard </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li class="active">
            <a class="nav-link" href="./tables.html">
              <i class="material-icons">content_paste</i>
              <p>Table List</p>
            </a>
          </li>
          <li>
            <a class="nav-link" href="./map.html">
              <i class="material-icons">location_ons</i>
              <p>Maps</p>
            </a>
          </li>
          <li>
            <a class="nav-link" href="./notifications.html">
              <i class="material-icons">notifications</i>
              <p>Notifications</p>
            </a>
          </li>
          <li>
            <a class="nav-link" href="./user.html">
              <i class="material-icons">bubble_chart</i>
              <p>Send Code</p>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid"> <!--icons side-->
          <div >
            <a class="navbar-brand" href="javascript:;">PROBLEMS TABLE</a>
          </div>
        
        </div>
      </nav>
      <!-- End Navbar -->
      <div class="content">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <div class="card">
                <div class="card-header card-header-primary">
                  <h4 class="card-title ">CODES AND SOLUTIONS</h4>
                  <p class="card-category"> Here is code of problem and solution</p>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table" id="table1">
                      <thead class=" text-primary">
                        <th>
                          Code
                        </th>
                        <th>
                          Problem
                        </th>
                        <th>
                          Solution File
                        </th>
                        <th>
                          Edit
                        </th>
                        <th>
                          Remove
                        </th>
                      </thead>
                      <tbody>
<tr id="data">

</tr>
                        <!-- <tr>
                          <td>
                            1
                          </td>
                          <td>
                            Fixing
                          </td>
                          <td>
                            Solution.pdf                          
                          </td>
                          <td>
                            <button  class="btn-edit">Edit</button>
                          </td>
                          <td >
                            <button class="btn-remove">Remove</button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            2
                          </td>
                          <td>
                            Fixing
                          </td>
                          <td>
                            Solution.pdf                          
                          </td>
                          <td>
                            <button  class="btn-edit">Edit</button>
                          </td>
                          <td >
                            <button class="btn-remove">Remove</button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            3
                          </td>
                          <td>
                            Fixing
                          </td>
                          <td>
                            Solution.pdf                          
                          </td>
                          <td>
                            <button  class="btn-edit">Edit</button>
                          </td>
                          <td >
                            <button class="btn-remove">Remove</button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            4
                          </td>
                          <td>
                            Fixing
                          </td>
                          <td>
                            Solution.pdf                          
                          </td>
                          <td>
                            <button  class="btn-edit">Edit</button>
                          </td>
                          <td >
                            <button class="btn-remove">Remove</button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            5
                          </td>
                          <td>
                            Fixing
                          </td>
                          <td>
                            Solution.pdf                          
                          </td>
                          <td>
                            <button  class="btn-edit">Edit</button>
                          </td>
                          <td >
                            <button class="btn-remove">Remove</button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            6
                          </td>
                          <td>
                            Fixing
                          </td>
                          <td>
                            Solution.pdf                          
                          </td>
                          <td>
                            <button  class="btn-edit">Edit</button>
                          </td>
                          <td >
                            <button class="btn-remove">Remove</button>
                          </td>
                        </tr> -->
                        <!-- <img src="" alt=""> -->
                      </tbody>
                    </table>
                    <button style=" margin-left: 400px; background-color: blue; color: cornsilk; border-radius: 10px; padding: 5px;">Add Problem</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
        </div>
      </footer>
    </div>
  
    <script>
  

      window.addEventListener('load', () => {
    let api = "http://localhost:7000/api/problem/";
    let table = document.getElementById("data");
    var table1 = document.getElementById("table1");
    let problems = [];
    console.log(table1);


    initialize();

    function initialize() {
   
  fetch(api)
    .then(response => {
      // console.log(response);
      return response.json();
    })
    .then(data => {
      console.log("data",data)
      problems.push(...data);
      console.log(problems);
  //    console.log(problems[1].problem);
 
      for (var i = 0; i < problems.length; i++) {
        var row = table1.insertRow(-1); // -1 to append at end of table
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        cell1.innerHTML = i+1;
        disvar=1;
        cell2.innerHTML = `<p>${ problems[i].problem}</p>`;
        cell3.innerHTML = `<a href=${problems[i]?.problemFile?.originalname} download>Download File</a>`
        //problems[i]?.problemFile?.filename;
        // cell4.innerHTML = `<button class="btn-edit" onclick="@location.href=http://localhost:7000/addProblem">Edit</button>`
        cell4.innerHTML = `<button class="btn-edit" onclick="getoneproblem('${problems[i]._id}')">Edit</button>`

        cell5.innerHTML = `<button class="btn-remove" onclick="deleteProblem('${problems[i]._id}','${i}')">Delete</button>`
      }
    });
}
    // refresh.addEventListener('click', () => {
    //     table.innerHTML = '';
    //     initialize();
    // })

});
    
//         var raw = "";

// var requestOptions = {
//   method: 'GET',
//   body: raw,
//   redirect: 'follow'
// };
// let problems;
// fetch("localhost:7000/api/problem/", requestOptions)
//   .then(response => response.text())
//   .then(result => {console.log(result)
//   problems=result.problems;
//   })
//   .catch(error => console.log('error', error));

    function addPrpoblem(){
      const raw={};
      fetch('http://localhost:7000/api/problem/', {
  body: raw,
  method: 'POST',
})
.then(res => res.json()) // or res.json()
.then(res => console.log(res))
.then(res=>{
  location.reload();
})
  .catch(error => console.log('error', error));


    }  

     function deleteProblem(id,i){
       console.log(id,i)
      fetch('http://localhost:7000/api/problem/' + id, {
  method: 'DELETE',
})
.then(res => res.json()) // or res.json()
.then(res => console.log(res))
.then(res=>{
  location.reload();
})
  .catch(error => console.log('error', error));

//       var raw = "";

// var requestOptions = {
//   method: 'DELETE',
//   body: raw,
//   redirect: 'follow'
// };

// fetch(`localhost:7000/api/problem/${id}`, requestOptions)
//   .then(response => response.text())
//   .then(result => console.log(result))
//   .catch(error => console.log('error', error));
     }
     function getoneproblem(id){
      

        fetch(`http://localhost:7000/api/problem/${id}`, {
  method: 'get',
}).then(response=>{

console.log(response)
          return response.json();

        }).then(data=>{
          console.log(data)
        })
      }
      </script>
  <!--   Core JS Files   -->
  <script src="../assets/js/core/jquery.min.js"></script> <!-- the top icons -->
  <script src="../assets/js/core/popper.min.js"></script> 
  <script src="../assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script> <!-- emotion icons-->
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../assets/js/material-dashboard.js?v=2.1.2" type="text/javascript"></script>
</body>

</html>